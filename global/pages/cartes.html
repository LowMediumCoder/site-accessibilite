<!DOCTYPE html>
<html>
	<head>
		<title>Site-Accessibilite</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
			crossorigin="anonymous" />
		<link
			rel="stylesheet"
			type="text/css"
			href="../css/style.css" />
	</head>
	<body>
		<div class="container mt-5">
			<h1 class="mb-4">Site Accessibilite</h1>
			<div class="row mb-4">
				<div class="col-md-5">
					<input
						type="text"
						class="form-control"
						placeholder="Search..."
						id="searchBar" />
				</div>
				<div class="col-md-4 text-end">
					<div
						class="btn-group"
						role="group"></div>
				</div>
			</div>
			<div
				class="row"
				id="cardGrid"></div>
		</div>
		<script>
			function filterCards(category) {
				const cards = document.querySelectorAll(".card-item");
				cards.forEach((card) => {
					if (
						category === "all" ||
						card.getAttribute("data-category") === category
					) {
						card.style.display = "block";
					} else {
						card.style.display = "none";
					}
				});
			}

			document
				.getElementById("searchBar")
				.addEventListener("input", function () {
					const searchTerm = this.value.toLowerCase();
					const cards = document.querySelectorAll(".card-item");
					cards.forEach((card) => {
						const title = card
							.querySelector(".card-title")
							.textContent.toLowerCase();
						if (title.includes(searchTerm)) {
							card.style.display = "block";
						} else {
							card.style.display = "none";
						}
					});
				});
			let activeCategory = "all";

			function filterCards(category) {
				if (activeCategory === category) {
					activeCategory = "all";
				} else {
					activeCategory = category;
				}

				const cards = document.querySelectorAll(".card-item");
				cards.forEach((card) => {
					if (
						activeCategory === "all" ||
						card.getAttribute("data-category") === activeCategory
					) {
						card.style.display = "block";
					} else {
						card.style.display = "none";
					}
				});

				const buttons = document.querySelectorAll(".btn-group .btn");
				buttons.forEach((button) => {
					if (button.getAttribute("data-category") === activeCategory) {
						button.classList.remove("btn-secondary");
						button.classList.add("btn-primary");
					} else {
						button.classList.remove("btn-primary");
						button.classList.add("btn-secondary");
					}
				});
			}

			document.addEventListener("DOMContentLoaded", () => {
				fetch("../data/cartes.json")
					.then((response) => response.json())
					.then((data) => {
						const categories = [
							"all",
							...data.familles.map((famille) => famille.id),
						];
						const buttonGroup = document.querySelector(".btn-group");

						categories.forEach((category) => {
							const button = document.createElement("button");
							button.className =
								category === "all" ? "btn btn-primary" : "btn btn-secondary";
							button.setAttribute("data-category", category);
							button.textContent =
								category === "all"
									? "All"
									: category.charAt(0).toUpperCase() + category.slice(1);
							button.onclick = () => filterCards(category);
							buttonGroup.appendChild(button);
						});

						const cardGrid = document.getElementById("cardGrid");
						cardGrid.innerHTML = "";

						data.familles.forEach((famille) => {
							famille.cartes.forEach((carte) => {
								const card = document.createElement("div");
								card.className = "col-md-3 mb-4 card-item";
								card.setAttribute("data-category", famille.titre);

								card.innerHTML = `
									<div class="card h-100">
										<img src="../img/cartes/${carte.id}.png" class="card-img-top" alt="${carte.titre}" />
										<div class="card-body">
											<h5 class="card-title">${carte.titre}</h5>
											<p class="card-text">${carte.description}</p>
										</div>
									</div>
								`;

								cardGrid.appendChild(card);
							});
						});
					})
					.catch((error) => console.error("Error fetching data:", error));
			});
		</script>
	</body>
</html>
